<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>TikTok Downloader</title>

<style>
body {background:#0f0f0f; color:white; font-family:Arial,sans-serif; text-align:center; padding:30px;}
input {width:90%; padding:12px; border-radius:10px; border:none; margin-bottom:15px;}
button {padding:12px 20px; border-radius:10px; border:none; cursor:pointer; font-weight:bold;}
.fetch-btn {background:#444; color:white;}
.download-btn {background:#ff4081; color:white; margin:8px;}
.clear-btn {background:#00bcd4; color:white; margin:8px;}
.paste-btn {background:#673ab7; color:white; margin:8px;}
.card {margin-top:20px; padding:20px; background:#1a1a1a; border-radius:15px;}
img {width:200px; border-radius:10px;}
.powered {opacity:0.7; margin-top:-10px; margin-bottom:20px;}
</style>
</head>

<body>

<h2>TikTok Downloader</h2>
<div class="powered">Powered by ğ‘·ğ‘¹ğ‘¬ğ‘ªğ‘°ğ‘¶ğ‘¼ğ‘º xâ™¡</div>

<input id="link" placeholder="Paste video link">
<br>
<button class="fetch-btn" onclick="getMedia()">Fetch Media</button>
<button class="paste-btn" onclick="pasteLink()">Paste</button>
<button class="clear-btn" onclick="clearLink()">Clear</button>

<div id="result"></div>

<script>
async function getMedia() {
  const url = document.getElementById("link").value;
  if(!url) return alert("Paste a link!");
  
  const res = await fetch("/preview?url=" + encodeURIComponent(url));
  const data = await res.json();

  if(!data.qualities) {
    document.getElementById("result").innerHTML = "Cannot fetch media";
    return;
  }

  let buttons = "";
  data.qualities.forEach(q => {
    buttons += `<a href="/download?url=${encodeURIComponent(q.url)}">
                  <button class="download-btn">${q.label}</button>
                </a>`;
  });

  document.getElementById("result").innerHTML = `
    <div class="card">
      <img src="${data.thumbnail}">
      <div>${buttons}</div>
    </div>
  `;
}

function clearLink() {
  document.getElementById("link").value = "";
  document.getElementById("result").innerHTML = "";
}

async function pasteLink() {
  try {
    const text = await navigator.clipboard.readText();
    document.getElementById("link").value = text;
  } catch (err) {
    alert("Allow clipboard permission to paste link");
  }
}
</script>

</body>
</html>
